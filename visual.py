import net as n
import pygame
import random


class NetVisual:


    def __init__(self, screen_size, x, y, net):
        pygame.init()
        self.display = pygame.display.set_mode(screen_size)
        pygame.display.set_caption("net visual")
        self.start_x = x
        self.start_y = y

        self.net = net

    def main(self, a):
        activations = self.net.forward_propogate(a)

        m = len(activations[0])
        for a in activations:
            if len(a) > m:
                m = len(a)
        min_w = min(self.net.weights)
        max_w = max(self.net.weights)

        self.display.fill((0, 0, 0))

        for l in range(len(self.net.layers)):
            self.draw_layer(activations[l], m, l*200)

        pygame.display.update()

        end = False
        while not end:

            for event in pygame.event.get():
                if event.type == pygame.KEYDOWN:
                    if event.key == pygame.K_SPACE:
                        end = True

    def draw_weights(self, min_w, max_w):
        pass

    def draw_layer(self, a, m, x):
        y = (m-len(a))*50/2

        for i in range(len(a)):
            pygame.draw.circle(self.display, (int(a[i]*250), int(a[i]*250), int(a[i]*250)), [int(self.start_x+x), int(self.start_y+y+(i*50))], 10)
            #pygame.draw.circle(self.display, (255, 255, 255), [int(self.start_x+x), int(self.start_y+y+(i*50))], 10, 1)


net = n.Net([8, 15, 1])
net.set_prams([0.4341715714629255, 0.3725622422144207, 1.9725417493220143, -0.5085267539609198, 0.8324257681917161, -1.3634913851385742, -0.2611416094904415, 0.03732673089252947, 2.3465318930933186, 3.352112876769389, 1.6815126582101327, 3.2391404546803377, -0.835203928381449, 2.8511656051120897, 0.09527805864793748, -2.0089417392644155, 2.9432724880291907, 3.752107994530921, -3.78696485546488, -0.23066570192267877, -0.813819182603534, 1.0847006764979628, -0.725643731395414, 1.6538243294820116, -1.0753563031941065, 5.607758209237522, -1.401638370017582, 0.2827610868034154, -2.090657589471012, -0.2915942073188065, -1.7038945243748227, -0.01945440614828642, 1.3933338056289495, 3.2180246191550896, 0.5851129315304031, -0.5153445822037744, 0.5822790288243415, -2.7530777360924135, 1.1474320231894555, -0.7268991218198498, 0.4587099739164372, 1.2307848293325923, 1.5723010113923346, -0.4777442829899493, -1.79313702310982, 1.5514242947942098, 3.4686961513612857, 0.6023272918782482, -0.414664729990993, 1.0014144327040562, 4.376543629892996, -0.23273031188848026, 0.4436134180387097, 2.6407379753044116, 1.173640283794561, -0.1662159610531876, 0.11948621976901952, 3.2188858353083853, 1.490944642220739, 0.7279572944965482, 1.1185147903605084, -0.46227638606616306, -1.144192924174761, -0.9224872501794691, -0.05463036880108396, 0.7872185393509902, 0.01728732075992301, 0.7732575660692448, 1.6365359176440215, 1.4817748055761384, -0.7311626865211037, 1.8288889767878165, 0.8644751135793209, -0.082125426086472, 3.2614311161660017, 2.8567156994432144, 0.2560062211690174, 1.0153821575735673, 1.1462243386308604, 0.756014733178686, 1.2146431196528176, 2.467986977613756, 1.0279032955072134, 1.002114493246704, -1.05452695736213, 2.1924703859764114, 0.32305612494340963, -1.9507724830436555, 0.9951252964521533, 0.8777575363696832, 1.7739035314509022, 3.081950527135514, -0.16027403292286824, 0.14457640139297256, 1.7187562079759244, 1.3368247882657855, 1.253734458200831, 1.01407619302773, -0.8586009054969552, -0.1557421927602901, 2.21329010062568, 1.7318767988073271, 1.662005606100311, -0.39416687817323504, 2.516494721897079, 1.2291897860633394, -0.8130560676369772, -1.180633159047488, -0.9437717673059627, -0.11337890534622486, 1.8292159595326747, 2.101711812381434, -2.67763561493786, 3.207547316600659, 2.0321603423115606, 1.0641675032349434, 1.5495682881339716, 2.886638946498322, 1.4112878715766968, -0.23032879734028355, 0.9324312124941134, -1.8878068151370626, 0.2008228469163944, -2.8274999633247018, 2.1979446833801135, -0.9689335776611995, 1.4291571166738475, -2.340409431268844, -0.006783419594791673, -1.1080369995827888, 4.26695140916501, -0.7024472536469943, -0.7922796126998537, 0.9827008578991154, -1.426784619936297, 0.8939999533245099, -0.11950992262994786, 1.8574759524687248, -0.4007875872406893, -3.5382407564627516, -0.6096026623804789, 2.2199939827810145, -2.0007010196685826, 4.545241778852711, 0.027530876328381804, -0.6203602909131682, 2.772814743408561, 0.6282392986029374, 2.5337278608499383, 1.8282059757333986, 0.7758525607499648])
nv = NetVisual([700, 800], 100, 50, net)

for i in range(100):
    nv.main([random.random() for i in range(0, 8)])